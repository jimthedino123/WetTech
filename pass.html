<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Floptropican Passport Maker</title>

<style>
body {
    font-family: Arial, sans-serif;
    background:#e9f7e2;
    margin:0;
    padding:20px;
}

.container {
    max-width:900px;
    margin:auto;
    background:white;
    padding:20px;
    border-radius:10px;
}

input, button {
    padding:8px;
    margin-top:10px;
    width:100%;
}

.passport-page {
    width: 600px;
    height: 800px;
    position: absolute;
    left:-9999px;   /* <-- makes it invisible but still renderable */
    top:0;
    overflow:hidden;
}

/* FRONT COVER */
.cover-bg { background:#cfe7c8; }

.cover-coa {
    position:absolute;
    top:27%;
    left:50%;
    transform:translateX(-50%);
    width:40%;
    opacity:0.9;
}

.cover-flags img {
    width:65px;
    margin-right:10px;
}

.cover-flags {
    position:absolute;
    top:20px;
    left:20px;
    display:flex;
}

.cover-title {
    position:absolute;
    bottom:110px;
    left:50%;
    transform:translateX(-50%);
    text-align:center;
    font-size:22px;
    font-weight:bold;
}

.scan-symbol {
    position:absolute;
    bottom:30px;
    left:50%;
    transform:translateX(-50%);
    width:60px;
}

/* ID PAGE */
.id-photo {
    width:150px;
    height:200px;
    border:1px solid #aaa;
    object-fit:cover;
}

.id-info {
    margin-top:20px;
    font-size:18px;
}

/* STAMP PAGE */
.stamp-page {
    font-size:22px;
    color:#444;
    padding:40px;
}
</style>
</head>

<body>

<div class="container">
    <h2>Floptropican Passport Generator</h2>

    <label>Your Name</label>
    <input id="nameInput">

    <label>Date of Birth</label>
    <input id="dobInput">

    <label>Passport Number</label>
    <input id="passNumInput">

    <label>Upload Your Photo</label>
    <input type="file" id="photoInput" accept="image/*">

    <label>coa.png</label><input type="file" id="coaInput" accept="image/*">
    <label>fl1.png</label><input type="file" id="fl1Input" accept="image/*">
    <label>fl2.png</label><input type="file" id="fl2Input" accept="image/*">
    <label>d.png</label><input type="file" id="dInput" accept="image/*">

    <button onclick="generatePDF()">Generate Passport PDF</button>
</div>

<!-- PAGES (off-screen but visible to html2canvas) -->

<div id="page1" class="passport-page cover-bg">
    <div class="cover-flags">
        <img id="fl1Img">
        <img id="fl2Img">
    </div>
    <img id="coaImg" class="cover-coa">
    <div class="cover-title">
        Republic of Floptropica Passport <br>
        弗洛普热西亚共和国护照
    </div>
    <img id="scanImg" class="scan-symbol">
</div>

<div id="page2" class="passport-page" style="background:white; padding:40px;">
    <h2>Identity Information</h2>
    <img id="photoPreview" class="id-photo">
    <div class="id-info" id="idText"></div>
</div>

<div id="page3" class="passport-page stamp-page">
    <h2>Visa & Entry Stamps</h2>
    <p>Space for stamps…</p>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
function readFileAsURL(file) {
    return new Promise(resolve => {
        const reader = new FileReader();
        reader.onload = e => resolve(e.target.result);
        reader.readAsDataURL(file);
    });
}

async function generatePDF() {
    const { jsPDF } = window.jspdf;
    let pdf = new jsPDF({ unit:"px", format:[600,800] });

    // Load files
    const files = {
        photo: photoInput.files[0],
        coa: coaInput.files[0],
        fl1: fl1Input.files[0],
        fl2: fl2Input.files[0],
        d:   dInput.files[0]
    };
    const urls = {};

    for (const key in files) {
        if (files[key]) urls[key] = await readFileAsURL(files[key]);
    }

    // Insert images in DOM
    if (urls.photo) photoPreview.src = urls.photo;
    if (urls.coa)   coaImg.src = urls.coa;
    if (urls.fl1)   fl1Img.src = urls.fl1;
    if (urls.fl2)   fl2Img.src = urls.fl2;
    if (urls.d)     scanImg.src = urls.d;

    // Set text
    idText.innerHTML = `
        <strong>Name:</strong> ${nameInput.value}<br>
        <strong>D.O.B:</strong> ${dobInput.value}<br>
        <strong>Passport Number:</strong> ${passNumInput.value}
    `;

    async function pageToPDF(divId, isFirst) {
        const canvas = await html2canvas(document.getElementById(divId), {scale:2});
        const img = canvas.toDataURL("image/png");
        if (!isFirst) pdf.addPage();
        pdf.addImage(img, "PNG", 0, 0, 600, 800);
    }

    await pageToPDF("page1", true);
    await pageToPDF("page2", false);
    await pageToPDF("page3", false);

    pdf.save("Floptropica_Passport.pdf");
}
</script>

</body>
</html>