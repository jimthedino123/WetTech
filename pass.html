<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cvmberty Island Passport Generator</title>

<style>
body {
    font-family: Arial, sans-serif;
    background:#e9f7e2;
    margin:0;
    padding:20px;
}
.container {
    max-width:900px;
    margin:auto;
    background:white;
    padding:20px;
    border-radius:10px;
}
input, button { width:100%; padding:10px; margin-top:10px; }

/* Hidden pages (rendered off-screen but visible to html2canvas) */
.passport-page {
    width:600px;
    height:800px;
    position:absolute;
    left:-9999px;
    top:0;
    overflow:hidden;
}

/* Guilloche pattern */
.guilloche {
    position:absolute;
    width:100%;
    height:100%;
    background: repeating-linear-gradient(
        45deg,
        rgba(0,120,90,0.12) 0px,
        rgba(0,120,90,0.12) 2px,
        rgba(0,120,90,0.05) 2px,
        rgba(0,120,90,0.05) 4px
    );
    pointer-events:none;
}

/* Microtext */
.microtext {
    position:absolute;
    bottom:5px;
    width:100%;
    font-size:6px;
    text-align:center;
    opacity:0.6;
    letter-spacing:1px;
}

/* Page 1 — Cover */
.cover {
    background:#cfe7c8;
}
.cover-coa {
    position:absolute;
    top:25%;
    left:50%;
    transform:translateX(-50%);
    width:42%;
}
.cover-flags {
    position:absolute;
    top:20px;
    left:20px;
    display:flex;
}
.cover-flags img { width:70px; margin-right:10px; }
.cover-title {
    position:absolute;
    bottom:110px;
    left:50%;
    transform:translateX(-50%);
    font-size:22px;
    text-align:center;
    font-weight:bold;
}
.scan-symbol {
    position:absolute;
    bottom:30px;
    left:50%;
    transform:translateX(-50%);
    width:60px;
}

/* Page 2 — ID Page */
.id-photo {
    width:160px;
    height:210px;
    border:1px solid #444;
    object-fit:cover;
    position:relative;
    z-index:2;
}

/* hologram effect */
.holo {
    position:absolute;
    top:0;
    left:0;
    width:160px;
    height:210px;
    background:linear-gradient(135deg,
        rgba(255,255,255,0.0) 0%,
        rgba(0,255,255,0.2) 30%,
        rgba(255,0,255,0.2) 60%,
        rgba(255,255,255,0.0) 100%
    );
    mix-blend-mode:screen;
    animation:shine 4s infinite linear;
}
@keyframes shine {
    0% {opacity:0;}
    50% {opacity:1;}
    100% {opacity:0;}
}

.id-container { position:relative; }

/* Page 3 — Stamps */
.stamp-page {
    padding:40px;
    background:white;
    font-size:22px;
}

</style>
</head>
<body>

<div class="container">
    <h2>Cvmberty Island Passport Generator</h2>
    <label>Your Full Name</label>
    <input id="nameInput">

    <label>Date of Birth</label>
    <input id="dobInput" placeholder="DD/MM/YYYY">

    <label>Passport Number</label>
    <input id="passNumInput" placeholder="CVI-XXXXXX">

    <label>Upload Your Photo</label>
    <input type="file" id="photoInput" accept="image/*">

    <button onclick="generatePDF()">Generate Passport PDF</button>
</div>

<!-- Pages off-screen -->

<div id="page1" class="passport-page cover">
    <div class="guilloche"></div>

    <div class="cover-flags">
        <img src="fl1.png">
        <img src="fl2.png">
    </div>

    <img src="coa.png" class="cover-coa">

    <div class="cover-title">
        Republic of Floptropica – Cvmberty Island<br>
        弗洛普热西亚共和国（坎伯蒂岛）护照
    </div>

    <img src="d.png" class="scan-symbol">

    <div class="microtext">
        CVMBERTY ISLAND OFFICIAL PASSPORT · MICROTEXT SECURITY LINE · DO NOT DUPLICATE
    </div>
</div>

<div id="page2" class="passport-page" style="background:white; padding:40px;">
    <div class="guilloche"></div>

    <h2>Identity Page — Cvmberty Island</h2>

    <div class="id-container">
        <img id="photoPreview" class="id-photo">
        <div class="holo"></div>
    </div>

    <div style="margin-top:20px; font-size:18px;">
        <div id="idText"></div>
    </div>

    <!-- MRZ -->
    <div style="position:absolute; bottom:40px; left:40px; right:40px; font-family:'Courier New', monospace; font-size:14px;">
        <div id="mrz1"></div>
        <div id="mrz2"></div>
    </div>

    <div class="microtext">
        CVMBERTY ISLAND SECURE IDENTITY AREA
    </div>
</div>

<div id="page3" class="passport-page stamp-page">
    <h2>Visa & Entry Stamps</h2>
    <p>Space for stamps…</p>

    <div class="microtext">
        CVMBERTY ISLAND VISA PAGE — MICROTEXT SECURITY LINE
    </div>
</div>

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
function fileToURL(file) {
    return new Promise(res=>{
        const r=new FileReader();
        r.onload=e=>res(e.target.result);
        r.readAsDataURL(file);
    });
}

async function generatePDF(){
    const {jsPDF}=window.jspdf;
    let pdf=new jsPDF({unit:"px",format:[600,800]});

    // selfie
    if(photoInput.files[0]){
        const url=await fileToURL(photoInput.files[0]);
        photoPreview.src=url;
    }

    // fill ID text
    const name=nameInput.value.toUpperCase();
    const dob=dobInput.value;
    const pnum=passNumInput.value.toUpperCase();
    idText.innerHTML=`
        <strong>Name:</strong> ${name}<br>
        <strong>Date of Birth:</strong> ${dob}<br>
        <strong>Passport No:</strong> ${pnum}<br>
        <strong>Nationality:</strong> CVMBERTY ISLAND (CVI)
    `;

    // MRZ (ICAO format, using CVI)
    const mrzName=name.replace(/ /g,"<");
    const filler="<<<<<<<<<<<<<<<<<<<";

    document.getElementById("mrz1").textContent =
        `P<CVI${mrzName}${filler}`.slice(0,44);

    document.getElementById("mrz2").textContent =
        `${pnum}CVI${dob.replace(/\//g,"")}M<<<<<<<<<<<<<<<<<`.slice(0,44);

    async function renderPage(id,isFirst){
        const canvas=await html2canvas(document.getElementById(id),{scale:2});
        const img=canvas.toDataURL("image/png");
        if(!isFirst) pdf.addPage();
        pdf.addImage(img,"PNG",0,0,600,800);
    }

    await renderPage("page1",true);
    await renderPage("page2",false);
    await renderPage("page3",false);

    pdf.save("Cvmberty_Island_Passport.pdf");
}
</script>

</body>
</html>