<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FlopRate Certificate Generator</title>

<!-- jsPDF CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #ffffff;
        padding: 20px;
        color: #222;
        max-width: 600px;
        margin: auto;
    }

    h1 {
        text-align: center;
        margin-bottom: 30px;
    }

    label {
        font-weight: bold;
        display: block;
        margin-top: 15px;
        margin-bottom: 5px;
    }

    input, select {
        width: 100%;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 6px;
        background: #fff;
        color: #222;
    }

    button {
        margin-top: 25px;
        width: 100%;
        padding: 12px;
        font-size: 17px;
        font-weight: bold;
        border: none;
        border-radius: 6px;
        background: #d40000;
        color: white;
        cursor: pointer;
        transition: 0.2s;
    }

    button:hover {
        background: #b30000;
    }
</style>
</head>
<body>

<h1>FlopRate Certificate Generator</h1>

<label>Show or Movie Title</label>
<input type="text" id="title" placeholder="Enter the title">

<label>Age Rating</label>
<select id="rating">
    <option value="FR-K">FR-K - suitable for all</option>
    <option value="FR-PG">FR-PG - suitable for 7+ with parental supervision</option>
    <option value="FR-T">FR-T - suitable for teens</option>
    <option value="FR-R">FR-R - suitable only for adults</option>
</select>

<button onclick="makePDF()">Done</button>

<script>
async function makePDF() {
    const { jsPDF } = window.jspdf;

    const doc = new jsPDF({
        orientation: "portrait",
        unit: "pt",
        format: "a4"
    });

    const title = document.getElementById("title").value;
    const rating = document.getElementById("rating").value;

    // Load images
    const floprateImg = await toDataURL("https://floprate.netlify.app/logo.png");
    const fwbImg = await toDataURL("https://floprate.netlify.app/fwb.png");

    // Add FlopRate logo
    doc.addImage(floprateImg, "PNG", 200, 40, 180, 180);

    doc.setFont("Helvetica", "normal");
    doc.setFontSize(20);

    // Show title with large blank area below
    doc.text("Your show:", 50, 270);
    doc.setFontSize(28);
    doc.text(title || "_____________________________", 50, 310);

    doc.setFontSize(20);
    doc.text("has been awarded this age rating by our team:", 50, 360);

    // Another large blank area
    doc.setFontSize(28);
    doc.text(rating || "__________________________", 50, 410);

    // Add FlopWatch Broadcasting logo at bottom
    doc.addImage(fwbImg, "PNG", 200, 500, 180, 180);

    doc.save("FlopRate-Certificate.pdf");
}

function toDataURL(url) {
    return new Promise((resolve) => {
        const img = new Image();
        img.crossOrigin = "Anonymous";
        img.onload = () => {
            const canvas = document.createElement("canvas");
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext("2d");
            ctx.drawImage(img, 0, 0);
            resolve(canvas.toDataURL("image/png"));
        };
        img.src = url;
    });
}
</script>

</body>
</html>